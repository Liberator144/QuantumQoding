#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Ultimate TypeScript Sovereignty Protection
# This is the most comprehensive JavaScript prevention system

echo "🔍 ULTIMATE QUANTUM SAFEGUARD SCAN"
echo "======================================"

# Count all JavaScript files (excluding allowed directories)
JS_COUNT=$(find . -name "*.js" -o -name "*.jsx" | grep -v node_modules | grep -v dist | grep -v build | grep -v \.backup | grep -v \.husky | wc -l)

echo "JavaScript files detected: $JS_COUNT"

if [ $JS_COUNT -gt 0 ]; then
  echo ""
  echo "❌ QUANTUM BREACH DETECTED!"
  echo "❌ TypeScript Sovereignty VIOLATED!"
  echo "❌ COMMIT BLOCKED by Ultimate Safeguard"
  echo ""
  echo "JavaScript files found:"
  find . -name "*.js" -o -name "*.jsx" | grep -v node_modules | grep -v dist | grep -v build | grep -v \.backup | grep -v \.husky
  echo ""
  echo "🛡️  SOLUTION: Migrate all JavaScript files to TypeScript"
  echo "🛡️  Use: .js → .ts and .jsx → .tsx"
  echo "🛡️  Quantum Coherence MUST be maintained"
  echo ""
  exit 1
fi

echo "✅ Quantum Coherence: MAINTAINED"
echo "✅ TypeScript Sovereignty: PROTECTED"
echo "✅ Ultimate Safeguard: PASSED"
echo "🚀 Commit approved by Quantum Protection System"